<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<link href="__PUBLIC__/frontend/css/user.css" rel="stylesheet" type="text/css" />
<link href="__PUBLIC__/frontend/css/base.css" rel="stylesheet" type="text/css" />
<script src="__PUBLIC__/frontend/js/jquery.js" type="text/javascript"></script>

</head>

<body style="background:#FFF">
<div class="aq_iframe">
   <form action="{:U('Safeinfo/addphone')}" method="post" id="phoneadd">
        <p>
          <label for="username"><span style="color:#F00; margin-right:5px;">*</span>新手机号码</label>
          <input type="text" name="phoneadd" class="aqifm_srk"/>
        <p>
        <p>
          <label for="username"><span style="color:#F00; margin-right:5px;">*</span>手机验证码</label>
          <input type="text" name="phone" class="aqifm_srk2"/>
          <input name="" type="button" value="获取验证码" class="input2 zm" id="zm1" style="width:80px; height:35px; line-height:35px;background-color:#0E9DA9; color:#FFF; border:0;cursor:pointer;"/>
          <span class="tip_aq">
            <font class="yzts"></font>
          </span> 
      <div class="aqifm_con_but">
         <input name="" type="button" value="提&nbsp;&nbsp;交" class="jrb_but02" id="addphone"/>
      </div>
        </form>
</div>
<script>
 //添加手机号
    $("#addphone").click(function() {
        if ($("input[name='phoneadd']").val() == "" || $("input[name='phone']").val() == "") {
            $(".yzts").html("<font color=\"red\">请输入完整信息！</font>");
        } else {
            $.post('{:U("Safeinfo/addphone")}', $("#phoneadd").serialize(), function(str) {
                str = $.trim(str);
                if (str === '1') {
                    $(".yzts").html("<font color=\"#0E9DA9\">添加成功！</font>");
                    setTimeout(function() {
                        parent.location.reload();
                    }, 1000);
                } else if (str === '2') {
                    $(".yzts").html("<font color=\"red\">验证码输入错误！</font>");
                }
            })
        }
    })
	 //获取输入的手机验证码
    $("#zm1").click(function() {
        if ($("input[name='phoneadd']").val() == "") {
            $(".yzts").html("<font color=\"#a9a9a9\">请输入手机号码！</font>");
        } else{
            $.post('{:U("Safeinfo/code1")}', $("#phoneadd").serialize(), function(str) {
                str = $.trim(str);
                if (str === '1') {
                    fun_timedown(60);

                    $(".yzts").html("<font color=\"#0E9DA9\">已经发送！</font>");
                    $("#zm1").attr("disabled", "disabled");
                    $("#zm1").css({"color": "#000", "background-color": "#999"});
                    setTimeout(function() {
                        $(".yzts").html("");
                    }, 3000);

                } else {
                    $(".yzts").html("<font color=\"#a9a9a9\">发送失败！</font>");
                    // setTimeout(function(){location.reload();},1000);
                }
            })
        }
    })
	//60秒倒计时
function fun_timedown(time)
{
    if (time == 'undefined')
        time = 60;
    //$("#hqyzm").html(time+"秒");
    $(".zm").attr("value", time + "秒");

    time = time - 1;
    if (time >= 0)
    {
        setTimeout("fun_timedown(" + time + ")", 1000);
    } else
    {
        $(".zm").attr("disabled", "");
        $(".zm").css({"color": "#FFF", "background-color": "#0E9DA9"});
        $(".zm").attr("value", "获取验证码");

    }
}
</script>
</body>
</html>
